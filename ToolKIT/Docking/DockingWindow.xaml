<Window x:Class="ToolKIT.Docking.DockingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ToolKIT.Docking"
        xmlns:dockBehaviors="clr-namespace:ToolKIT.Docking.Behaviors"
        xmlns:converters="clr-namespace:ToolKIT.Converters"
        xmlns:system="clr-namespace:System;assembly=netstandard"
        mc:Ignorable="d"
        Title="DockingWindow"
        d:DataContext="{d:DesignInstance local:DockingContainerVM}">

    <Window.Resources>
        <ResourceDictionary>
            <DataTemplate DataType="{x:Type local:TestDockPanel}">
                <Rectangle Fill="{Binding Fill}" />
            </DataTemplate>

            <converters:DisplayNameOrTypeConverter x:Key="DisplayNameOrTypeConverter" />
        </ResourceDictionary>
    </Window.Resources>

    <TabControl ItemsSource="{Binding DockedPanelTitles}"
                TabStripPlacement="Bottom"
                AllowDrop="True"
                BorderThickness="0"
                Padding="0">
        <TabControl.ContentTemplate>
            <DataTemplate>
                <DockPanel LastChildFill="True">
                    <DockPanel DockPanel.Dock="Top"
                               LastChildFill="True">

                        <StackPanel DockPanel.Dock="Right"
                                    Orientation="Horizontal">
                            <Button Content="v"
                                    MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                                    MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                                    BorderThickness="0"
                                    Background="Transparent" />
                            <Button Content="o"
                                    MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                                    MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                                    BorderThickness="0"
                                    Background="Transparent" />
                            <Button Content="X"
                                    MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                                    MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                                    BorderThickness="0"
                                    Background="Transparent" />
                        </StackPanel>

                        <TextBlock DockPanel.Dock="Left"
                                   Text="{Binding ., Converter={StaticResource DisplayNameOrTypeConverter}}" />
                    </DockPanel>

                    <ContentPresenter Content="{Binding}" />
                </DockPanel>
            </DataTemplate>
        </TabControl.ContentTemplate>
        <TabControl.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding ., Converter={StaticResource DisplayNameOrTypeConverter}}" />
            </DataTemplate>
        </TabControl.ItemTemplate>
        <i:Interaction.Behaviors>
            <dockBehaviors:TabControlReorderTabItemBehavior />
            <dockBehaviors:TabControlFloatTabItemBehavior />
        </i:Interaction.Behaviors>
    </TabControl>

    <!--
    <Grid>
        <!- - Docking Container - ->
        <DockPanel LastChildFill="True">

            <!- - Header DockedTabs - ->
            <DockPanel DockPanel.Dock="Top"
                       LastChildFill="True">

                <StackPanel DockPanel.Dock="Right"
                            Orientation="Horizontal">
                    <Button Content="v"
                            MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                            MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                            BorderThickness="0"
                            Background="Transparent" />
                    <Button Content="o"
                            MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                            MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                            BorderThickness="0"
                            Background="Transparent" />
                    <Button Content="X"
                            MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                            MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                            BorderThickness="0"
                            Background="Transparent" />
                </StackPanel>

                <ListView DockPanel.Dock="Left"
                          ItemsSource="{Binding DockedPanelTitles}"
                          SelectedIndex="{Binding SelectedIndex}"
                          SelectionMode="Single">

                    <ListView.Template>
                        <ControlTemplate TargetType="{x:Type ListView}">
                            <ItemsPresenter />
                        </ControlTemplate>
                    </ListView.Template>
                    <ListView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"
                                        Margin="0" />
                        </ItemsPanelTemplate>
                    </ListView.ItemsPanel>

                    <ListView.ItemContainerStyle>
                        <Style TargetType="{x:Type ListViewItem}">
                            <Setter Property="Padding"
                                    Value="0" />
                            <Setter Property="Margin"
                                    Value="0,0,1,0" />
                            <Setter Property="BorderThickness"
                                    Value="0" />
                            <Setter Property="VerticalContentAlignment"
                                    Value="Stretch" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate DataType="{x:Type ListBoxItem}">
                            <StackPanel Orientation="Horizontal"
                                        Height="20">
                                <ContentPresenter Content="{Binding}"
                                                  VerticalAlignment="Center"
                                                  Margin="2,0,6,0" />
                                <Button MinWidth="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                                        MinHeight="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"
                                        BorderThickness="0"
                                        Background="Transparent">
                                    <Path Fill="White"
                                          Stroke="White"
                                          StrokeThickness="1.25"
                                          RenderTransformOrigin="0.5, 0.5">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleX="0.75"
                                                            ScaleY="0.75" />
                                        </Path.RenderTransform>
                                        <Path.Data>
                                            <PathGeometry Figures="M 0,0 L 10,10 M 0,10 L 10,0" />
                                        </Path.Data>
                                    </Path>
                                </Button>

                                <i:Interaction.Behaviors>
                                    <local:DockTabDragBehavior />
                                </i:Interaction.Behaviors>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </DockPanel>

            <!- - Displayed Content - ->
            <ContentPresenter Content="{Binding SelectedPanel}" />
        </DockPanel>
    </Grid>
    -->

    <i:Interaction.Behaviors>
        <dockBehaviors:WindowCloseBehavior ShouldClose="{Binding ShouldClose}" />
    </i:Interaction.Behaviors>
</Window>
